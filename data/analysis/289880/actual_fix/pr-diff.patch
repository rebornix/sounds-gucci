diff --git a/src/vs/workbench/contrib/chat/electron-browser/chat.contribution.ts b/src/vs/workbench/contrib/chat/electron-browser/chat.contribution.ts
index 6f3bbc94e607b..7deac3c64b1ce 100644
--- a/src/vs/workbench/contrib/chat/electron-browser/chat.contribution.ts
+++ b/src/vs/workbench/contrib/chat/electron-browser/chat.contribution.ts
@@ -25,6 +25,9 @@ import { IWorkbenchLayoutService } from '../../../services/layout/browser/layout
 import { ILifecycleService, ShutdownReason } from '../../../services/lifecycle/common/lifecycle.js';
 import { ACTION_ID_NEW_CHAT, CHAT_OPEN_ACTION_ID, IChatViewOpenOptions } from '../browser/actions/chatActions.js';
 import { IChatWidgetService } from '../browser/chat.js';
+import { AgentSessionProviders } from '../browser/agentSessions/agentSessions.js';
+import { isSessionInProgressStatus } from '../browser/agentSessions/agentSessionsModel.js';
+import { IAgentSessionsService } from '../browser/agentSessions/agentSessionsService.js';
 import { ChatContextKeys } from '../common/actions/chatContextKeys.js';
 import { ChatModeKind } from '../common/constants.js';
 import { IChatService } from '../common/chatService/chatService.js';
@@ -120,7 +123,7 @@ class ChatLifecycleHandler extends Disposable {
 
 	constructor(
 		@ILifecycleService lifecycleService: ILifecycleService,
-		@IChatService private readonly chatService: IChatService,
+		@IAgentSessionsService private readonly agentSessionsService: IAgentSessionsService,
 		@IDialogService private readonly dialogService: IDialogService,
 		@IChatWidgetService private readonly widgetService: IChatWidgetService,
 		@IContextKeyService private readonly contextKeyService: IContextKeyService,
@@ -133,13 +136,18 @@ class ChatLifecycleHandler extends Disposable {
 		}));
 
 		this._register(extensionService.onWillStop(e => {
-			e.veto(this.chatService.requestInProgressObs.get(), localize('chatRequestInProgress', "A chat request is in progress."));
+			e.veto(this.hasNonCloudSessionInProgress(), localize('chatRequestInProgress', "A chat request is in progress."));
 		}));
 	}
 
+	private hasNonCloudSessionInProgress(): boolean {
+		return this.agentSessionsService.model.sessions.some(session =>
+			isSessionInProgressStatus(session.status) && session.providerType !== AgentSessionProviders.Cloud
+		);
+	}
+
 	private shouldVetoShutdown(reason: ShutdownReason): boolean | Promise<boolean> {
-		const running = this.chatService.requestInProgressObs.read(undefined);
-		if (!running) {
+		if (!this.hasNonCloudSessionInProgress()) {
 			return false;
 		}
 
