diff --git a/src/vs/workbench/contrib/notebook/browser/contrib/troubleshoot/layout.ts b/src/vs/workbench/contrib/notebook/browser/contrib/troubleshoot/layout.ts
index 3c0b9f6941c6a..9ee0597c6eeba 100644
--- a/src/vs/workbench/contrib/notebook/browser/contrib/troubleshoot/layout.ts
+++ b/src/vs/workbench/contrib/notebook/browser/contrib/troubleshoot/layout.ts
@@ -3,12 +3,12 @@
  *  Licensed under the MIT License. See License.txt in the project root for license information.
  *--------------------------------------------------------------------------------------------*/
 
-import { Disposable, DisposableStore, dispose, IDisposable } from '../../../../../../base/common/lifecycle.js';
+import { Disposable, DisposableStore, dispose, toDisposable } from '../../../../../../base/common/lifecycle.js';
 import { localize2 } from '../../../../../../nls.js';
 import { Categories } from '../../../../../../platform/action/common/actionCommonCategories.js';
 import { Action2, registerAction2 } from '../../../../../../platform/actions/common/actions.js';
 import { ServicesAccessor } from '../../../../../../platform/instantiation/common/instantiation.js';
-import { getNotebookEditorFromEditorPane, ICellViewModel, ICommonCellViewModelLayoutChangeInfo, INotebookDeltaCellStatusBarItems, INotebookEditor, INotebookEditorContribution } from '../../notebookBrowser.js';
+import { getNotebookEditorFromEditorPane, ICellViewModel, INotebookDeltaCellStatusBarItems, INotebookEditor, INotebookEditorContribution } from '../../notebookBrowser.js';
 import { registerNotebookContribution } from '../../notebookEditorExtensions.js';
 import { NotebookEditorWidget } from '../../notebookEditorWidget.js';
 import { CellStatusbarAlignment, INotebookCellStatusBarItem } from '../../../common/notebookCommon.js';
@@ -20,10 +20,9 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 	static id: string = 'workbench.notebook.troubleshoot';
 
 	private readonly _localStore = this._register(new DisposableStore());
-	private _cellStateListeners: IDisposable[] = [];
+	private _cellDisposables: DisposableStore[] = [];
 	private _enabled: boolean = false;
 	private _cellStatusItems: string[] = [];
-	private _cellOverlayIds: string[] = [];
 	private _notebookOverlayDomNode: HTMLElement | undefined;
 
 	constructor(private readonly _notebookEditor: INotebookEditor) {
@@ -43,8 +42,8 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 
 	private _update() {
 		this._localStore.clear();
-		this._cellStateListeners.forEach(listener => listener.dispose());
-		this._removeCellOverlays();
+		this._cellDisposables.forEach(d => d.dispose());
+		this._cellDisposables = [];
 		this._removeNotebookOverlay();
 
 		if (!this._notebookEditor.hasModel()) {
@@ -184,8 +183,11 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 
 		const getLayoutInfo = () => {
 			const eol = cell.textBuffer.getEOL() === '\n' ? 'LF' : 'CRLF';
-			const scrollTop = this._notebookEditor.getAbsoluteTopOfElement(cell);
-			return `cell #${index} (handle: ${cell.handle}) | AbsoluteTopOfElement: ${scrollTop}px | EOL: ${eol}`;
+			let scrollTop = '';
+			if (cell.layoutInfo.layoutState > 0) {
+				scrollTop = `| AbsoluteTopOfElement: ${this._notebookEditor.getAbsoluteTopOfElement(cell)}px`;
+			}
+			return `cell #${index} (handle: ${cell.handle}) ${scrollTop} | EOL: ${eol}`;
 		};
 		const label = document.createElement('div');
 		label.textContent = getLayoutInfo();
@@ -212,7 +214,6 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 		});
 
 		if (overlayId) {
-			this._cellOverlayIds.push(overlayId);
 
 			// Update overlay when layout changes
 			const updateLayout = () => {
@@ -227,35 +228,32 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 				}
 			};
 
-			this._localStore.add(cell.onDidChangeLayout((e) => {
+			const disposables = this._cellDisposables[index];
+			disposables.add(cell.onDidChangeLayout((e) => {
 				updateLayout();
 			}));
-			this._localStore.add(cell.textBuffer.onDidChangeContent(() => {
+			disposables.add(cell.textBuffer.onDidChangeContent(() => {
 				updateLayout();
 			}));
 			if (cell.textModel) {
-				this._localStore.add(cell.textModel.onDidChangeContent(() => {
+				disposables.add(cell.textModel.onDidChangeContent(() => {
 					updateLayout();
 				}));
 			}
-			this._localStore.add(this._notebookEditor.onDidChangeLayout(() => {
+			disposables.add(this._notebookEditor.onDidChangeLayout(() => {
 				updateLayout();
 			}));
+			disposables.add(toDisposable(() => {
+				this._notebookEditor.changeCellOverlays((accessor) => {
+					if (overlayId) {
+						accessor.removeOverlay(overlayId);
+					}
+				});
+			}));
 		}
 
 	}
 
-	private _removeCellOverlays() {
-		if (this._cellOverlayIds.length > 0) {
-			this._notebookEditor.changeCellOverlays((accessor) => {
-				for (const id of this._cellOverlayIds) {
-					accessor.removeOverlay(id);
-				}
-			});
-			this._cellOverlayIds = [];
-		}
-	}
-
 	private _removeNotebookOverlay() {
 		if (this._notebookOverlayDomNode) {
 			this._notebookOverlayDomNode.remove();
@@ -271,7 +269,9 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 		for (let i = 0; i < this._notebookEditor.getLength(); i++) {
 			const cell = this._notebookEditor.cellAt(i);
 
-			this._cellStateListeners.push(cell.onDidChangeLayout(e => {
+			const disposableStore = new DisposableStore();
+			this._cellDisposables.push(disposableStore);
+			disposableStore.add(cell.onDidChangeLayout(e => {
 				this._log(cell, e);
 			}));
 		}
@@ -279,14 +279,25 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 		this._localStore.add(this._notebookEditor.onDidChangeViewCells(e => {
 			[...e.splices].reverse().forEach(splice => {
 				const [start, deleted, newCells] = splice;
-				const deletedCells = this._cellStateListeners.splice(start, deleted, ...newCells.map(cell => {
-					return cell.onDidChangeLayout((e: ICommonCellViewModelLayoutChangeInfo) => {
+				const deletedCells = this._cellDisposables.splice(start, deleted, ...newCells.map(cell => {
+					const disposableStore = new DisposableStore();
+					disposableStore.add(cell.onDidChangeLayout(e => {
 						this._log(cell, e);
-					});
+					}));
+					return disposableStore;
 				}));
 
 				dispose(deletedCells);
 			});
+
+			// Add the overlays
+			const addedCells = e.splices.reduce((acc, [, , newCells]) => [...acc, ...newCells], [] as ICellViewModel[]);
+			for (let i = 0; i < addedCells.length; i++) {
+				const cellIndex = this._notebookEditor.getCellIndex(addedCells[i]);
+				if (cellIndex !== undefined) {
+					this._createCellOverlay(addedCells[i], cellIndex);
+				}
+			}
 		}));
 
 		const vm = this._notebookEditor.getViewModel();
@@ -297,6 +308,7 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 		}
 
 		this._cellStatusItems = vm.deltaCellStatusBarItems(this._cellStatusItems, items);
+
 	}
 
 	private _getItemsForCells(): INotebookDeltaCellStatusBarItems[] {
@@ -318,8 +330,7 @@ export class TroubleshootController extends Disposable implements INotebookEdito
 	}
 
 	override dispose() {
-		dispose(this._cellStateListeners);
-		this._removeCellOverlays();
+		dispose(this._cellDisposables);
 		this._removeNotebookOverlay();
 		this._localStore.clear();
 		super.dispose();
